<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phonics Fun: Syllable Patterns</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Fredoka+One&display=swap">
    <style>
        :root {
            --primary: #6a1b9a;
            --secondary: #ff6b6b;
            --accent: #26a69a;
            --light: #f7f9fc;
            --dark: #2d3436;
            --purple: #9b59b6;
            --yellow: #f1c40f;
            --green: #2ecc71;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Comic Neue', cursive;
        }
        
        body {
            background: linear-gradient(135deg, #e1bee7, #bbdefb);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark);
            overflow-x: hidden;
            direction: ltr;
        }
        
        header {
            text-align: center;
            margin-bottom: 31px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            animation: bounceIn 1s ease-out;
            position: relative;
            overflow: hidden;
        }
        
        .header-decoration {
            position: absolute;
            font-size: 4rem;
            opacity: 0.1;
            z-index: 0;
        }
        
        .decoration-left {
            left: 20px;
            top: 10px;
        }
        
        .decoration-right {
            right: 20px;
            bottom: 10px;
        }
        
        h1 {
            color: var(--primary);
            font-size: 3.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-family: 'Fredoka One', cursive;
            position: relative;
            z-index: 1;
        }
        
        .subtitle {
            color: var(--secondary);
            font-size: 1.8rem;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .syllable-selector {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
        }
        
        .syllable-btn {
            padding: 15px 25px;
            background: white;
            border: none;
            border-radius: 50px;
            font-size: 1.8rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .syllable-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .syllable-btn.active {
            background: var(--primary);
            color: white;
            animation: pulse 1.5s infinite;
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
        }
        
        .tab-btn {
            padding: 15px 30px;
            background: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .tab-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .tab-btn.active {
            background: var(--accent);
            color: white;
        }
        
        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            animation: fadeIn 0.5s ease-out;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .syllable-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .syllable-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            width: 300px;
            text-align: center;
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .syllable-card:hover {
            transform: translateY(-10px) rotate(2deg);
            box-shadow: 0 12px 24px rgba(0,0,0,0.15);
        }
        
        .syllable-title {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 15px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.1);
            font-family: 'Fredoka One', cursive;
        }
        
        .pronunciation {
            font-size: 1.8rem;
            color: var(--secondary);
            margin-bottom: 15px;
            font-family: 'Arial', sans-serif;
            background: #f0f7ff;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
        }
        
        .examples {
            text-align: left;
            margin-top: 20px;
        }
        
        .example-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            border-bottom: 1px dashed #eee;
            transition: all 0.3s ease;
            align-items: center;
        }
        
        .example-item:hover {
            background: #f0f7ff;
            border-radius: 8px;
            transform: translateX(5px);
        }
        
        .word-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .word-emoji {
            font-size: 1.8rem;
        }
        
        .word-text {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .word-translation {
            font-size: 1rem;
            color: #7f8c8d;
            font-style: italic;
            direction: rtl;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .syllable-highlight {
            color: var(--primary);
            font-weight: bold;
            text-decoration: underline;
        }
        
        .speaker-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.8rem;
            color: var(--accent);
            transition: transform 0.2s ease;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .speaker-btn:hover {
            transform: scale(1.2);
            background: #e8f4fc;
        }
        
        .practice-container, .quiz-container, .games-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .question-box {
            background: white;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .question {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--dark);
        }
        
        .options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }
        
        .option {
            padding: 15px 25px;
            background: var(--light);
            border: 2px solid var(--primary);
            border-radius: 50px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
        }
        
        .option:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }
        
        .feedback {
            margin-top: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            min-height: 40px;
            padding: 10px;
            border-radius: 10px;
        }
        
        .correct {
            color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
            animation: tada 1s;
        }
        
        .incorrect {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
            animation: shake 0.5s;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 15px 30px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }
        
        .progress-container {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .progress-bar {
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--accent);
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .score-display {
            font-size: 1.5rem;
            text-align: center;
            margin-top: 20px;
            color: var(--primary);
            font-weight: bold;
        }
        
        .game-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .game-card {
            height: 120px;
            background: var(--purple);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .game-card.flipped {
            transform: rotateY(180deg);
        }
        
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 15px;
        }
        
        .card-front {
            background: linear-gradient(135deg, var(--purple), var(--accent));
            color: white;
        }
        
        .card-back {
            background: white;
            color: var(--dark);
            transform: rotateY(180deg);
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .match {
            background: var(--green);
            transform: rotateY(180deg) scale(0.95);
        }
        
        .game-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes tada {
            0% { transform: scale(1); }
            10%, 20% { transform: scale(0.9) rotate(-3deg); }
            30%, 50%, 70%, 90% { transform: scale(1.1) rotate(3deg); }
            40%, 60%, 80% { transform: scale(1.1) rotate(-3deg); }
            100% { transform: scale(1) rotate(0); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        @keyframes flip {
            0% { transform: rotateY(0); }
            100% { transform: rotateY(180deg); }
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .floating {
            animation: float 3s ease-in-out infinite;
        }
        
        @media (max-width: 768px) {
            .syllable-card {
                width: 100%;
            }
            
            .game-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            h1 {
                font-size: 2.5rem;
            }
            
            .subtitle {
                font-size: 1.3rem;
            }
            
            .syllable-btn {
                font-size: 1.5rem;
                padding: 12px 20px;
            }
        }
        
        @media (max-width: 480px) {
            .game-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .syllable-btn {
                font-size: 1.3rem;
                padding: 10px 15px;
            }
            
            .tab-btn {
                padding: 12px 20px;
                font-size: 1rem;
            }
            
            .syllable-title {
                font-size: 3rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-decoration decoration-left">üî§üî°</div>
            <h1>Syllable Patterns üéµ</h1>
            <div class="subtitle">Learn: sure, tion, ssion, sion, ture</div>
            <p>Explore, practice, and master English syllable patterns with Arabic translations!</p>
            <div class="header-decoration decoration-right">üé∂üéì</div>
        </header>
        
        <div class="syllable-selector">
            <button class="syllable-btn active" data-syllable="sure">sure</button>
            <button class="syllable-btn" data-syllable="tion">tion</button>
            <button class="syllable-btn" data-syllable="ssion">ssion</button>
            <button class="syllable-btn" data-syllable="sion">sion</button>
            <button class="syllable-btn" data-syllable="ture">ture</button>
            <button class="syllable-btn" data-syllable="all">All Syllables üåà</button>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" data-tab="learn">Learn üéì</button>
            <button class="tab-btn" data-tab="practice">Practice ‚úçÔ∏è</button>
            <button class="tab-btn" data-tab="quiz">Quiz ‚ùì</button>
            <button class="tab-btn" data-tab="games">Games üéÆ</button>
        </div>
        
        <!-- Learn Section -->
        <div id="learn" class="tab-content active">
            <h2>Learning Center</h2>
            <p>Click on the speaker icon <span style="color:var(--accent)">üîä</span> to hear the words!</p>
            
            <div class="syllable-container">
                <!-- Syllable cards will be populated by JavaScript -->
            </div>
        </div>
        
        <!-- Practice Section -->
        <div id="practice" class="tab-content">
            <h2>Practice Time!</h2>
            <p>Listen to the word and select the syllable pattern you hear.</p>
            
            <div class="practice-container">
                <div class="question-box">
                    <div class="question" id="practice-word">Click Start to begin!</div>
                    <button class="speaker-btn floating" id="practice-speaker">üîä</button>
                    <div class="options" id="practice-options">
                        <!-- Options will be populated by JavaScript -->
                    </div>
                    <div class="feedback" id="practice-feedback"></div>
                </div>
                
                <div class="controls">
                    <button class="btn" id="practice-start">Start Practice</button>
                    <button class="btn" id="practice-next" disabled>Next Word</button>
                </div>
            </div>
        </div>
        
        <!-- Quiz Section -->
        <div id="quiz" class="tab-content">
            <h2>Quiz Challenge!</h2>
            <p>Answer the questions correctly to earn points.</p>
            
            <div class="quiz-container">
                <div class="progress-container">
                    <div>Progress: <span id="progress-text">0/0</span></div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                </div>
                
                <div class="question-box">
                    <div class="question" id="quiz-question">Click Start to begin the quiz!</div>
                    <div class="options" id="quiz-options">
                        <!-- Options will be populated by JavaScript -->
                    </div>
                    <div class="feedback" id="quiz-feedback"></div>
                </div>
                
                <div class="score-display">Score: <span id="quiz-score">0</span></div>
                
                <div class="controls">
                    <button class="btn" id="quiz-start">Start Quiz</button>
                    <button class="btn" id="quiz-next" disabled>Next Question</button>
                </div>
            </div>
        </div>
        
        <!-- Games Section -->
        <div id="games" class="tab-content">
            <h2>Memory Game üß†</h2>
            <p>Match the words with their syllable patterns!</p>
            
            <div class="games-container">
                <div class="game-stats">
                    <div>Moves: <span id="move-count">0</span></div>
                    <div>Matches: <span id="match-count">0</span>/8</div>
                    <div>Time: <span id="time-count">0</span>s</div>
                </div>
                
                <div class="game-grid" id="memory-game">
                    <!-- Game cards will be populated by JavaScript -->
                </div>
                
                <div class="controls">
                    <button class="btn" id="game-start">Start Game</button>
                    <button class="btn" id="game-reset">Reset Game</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Data structure for syllable patterns with Arabic translations
        const syllableData = {
            "syllables": [
                {
                    "syllable": "sure",
                    "examples": [
                        {"word": "measure", "translation": "ŸÇŸäÿßÿ≥", "emoji": "üìè"},
                        {"word": "pleasure", "translation": "ŸÖÿ™ÿπÿ©", "emoji": "üòä"},
                        {"word": "treasure", "translation": "ŸÉŸÜÿ≤", "emoji": "üíé"},
                        {"word": "closure", "translation": "ÿ•ÿ∫ŸÑÿßŸÇ", "emoji": "üö™"},
                        {"word": "exposure", "translation": "ÿ™ÿπÿ±ÿ∂", "emoji": "‚òÄÔ∏è"},
                        {"word": "leisure", "translation": "ÿ™ÿ±ŸÅŸäŸá", "emoji": "üèñÔ∏è"},
                        {"word": "pressure", "translation": "ÿ∂ÿ∫ÿ∑", "emoji": "‚öñÔ∏è"},
                        {"word": "composure", "translation": "ŸáÿØŸàÿ°", "emoji": "üßò"},
                        {"word": "disclosure", "translation": "ŸÉÿ¥ŸÅ", "emoji": "üîç"},
                        {"word": "enclosure", "translation": "ÿ≥ÿßÿ≠ÿ©", "emoji": "üèüÔ∏è"}
                    ]
                },
                {
                    "syllable": "tion",
                    "examples": [
                        {"word": "action", "translation": "ÿπŸÖŸÑ", "emoji": "üé¨"},
                        {"word": "education", "translation": "ÿ™ÿπŸÑŸäŸÖ", "emoji": "üéì"},
                        {"word": "information", "translation": "ŸÖÿπŸÑŸàŸÖÿßÿ™", "emoji": "‚ÑπÔ∏è"},
                        {"word": "nation", "translation": "ÿ£ŸÖÿ©", "emoji": "üåç"},
                        {"word": "attention", "translation": "ÿßŸÜÿ™ÿ®ÿßŸá", "emoji": "üëÄ"},
                        {"word": "station", "translation": "ŸÖÿ≠ÿ∑ÿ©", "emoji": "üöâ"},
                        {"word": "election", "translation": "ÿßŸÜÿ™ÿÆÿßÿ®", "emoji": "üó≥Ô∏è"},
                        {"word": "solution", "translation": "ÿ≠ŸÑ", "emoji": "‚úÖ"},
                        {"word": "direction", "translation": "ÿßÿ™ÿ¨ÿßŸá", "emoji": "üß≠"},
                        {"word": "production", "translation": "ÿ•ŸÜÿ™ÿßÿ¨", "emoji": "üè≠"}
                    ]
                },
                {
                    "syllable": "ssion",
                    "examples": [
                        {"word": "mission", "translation": "ŸÖŸáŸÖÿ©", "emoji": "üöÄ"},
                        {"word": "passion", "translation": "ÿ¥ÿ∫ŸÅ", "emoji": "‚ù§Ô∏è"},
                        {"word": "expression", "translation": "ÿ™ÿπÿ®Ÿäÿ±", "emoji": "üí¨"},
                        {"word": "discussion", "translation": "ŸÖŸÜÿßŸÇÿ¥ÿ©", "emoji": "üí¨"},
                        {"word": "profession", "translation": "ŸÖŸáŸÜÿ©", "emoji": "üë®‚Äç‚öïÔ∏è"},
                        {"word": "session", "translation": "ÿ¨ŸÑÿ≥ÿ©", "emoji": "ü™ë"},
                        {"word": "possession", "translation": "ŸÖŸÑŸÉŸäÿ©", "emoji": "üè†"},
                        {"word": "succession", "translation": "ÿÆŸÑÿßŸÅÿ©", "emoji": "üëë"},
                        {"word": "confession", "translation": "ÿßÿπÿ™ÿ±ÿßŸÅ", "emoji": "üó£Ô∏è"},
                        {"word": "impression", "translation": "ÿßŸÜÿ∑ÿ®ÿßÿπ", "emoji": "üë£"}
                    ]
                },
                {
                    "syllable": "sion",
                    "examples": [
                        {"word": "television", "translation": "ÿ™ŸÑŸÅÿßÿ≤", "emoji": "üì∫"},
                        {"word": "decision", "translation": "ŸÇÿ±ÿßÿ±", "emoji": "ü§î"},
                        {"word": "vision", "translation": "ÿ±ÿ§Ÿäÿ©", "emoji": "üëÅÔ∏è"},
                        {"word": "division", "translation": "ŸÇÿ≥ŸÖ", "emoji": "‚ûó"},
                        {"word": "collision", "translation": "ÿ™ÿµÿßÿØŸÖ", "emoji": "üí•"},
                        {"word": "explosion", "translation": "ÿßŸÜŸÅÿ¨ÿßÿ±", "emoji": "üí£"},
                        {"word": "conclusion", "translation": "ÿßÿ≥ÿ™ŸÜÿ™ÿßÿ¨", "emoji": "üîö"},
                        {"word": "revision", "translation": "ŸÖÿ±ÿßÿ¨ÿπÿ©", "emoji": "üìù"},
                        {"word": "invasion", "translation": "ÿ∫ÿ≤Ÿà", "emoji": "‚öîÔ∏è"},
                        {"word": "erosion", "translation": "ÿ™ÿ¢ŸÉŸÑ", "emoji": "‚õ∞Ô∏è"}
                    ]
                },
                {
                    "syllable": "ture",
                    "examples": [
                        {"word": "picture", "translation": "ÿµŸàÿ±ÿ©", "emoji": "üñºÔ∏è"},
                        {"word": "nature", "translation": "ÿ∑ÿ®Ÿäÿπÿ©", "emoji": "üå≥"},
                        {"word": "future", "translation": "ŸÖÿ≥ÿ™ŸÇÿ®ŸÑ", "emoji": "üîÆ"},
                        {"word": "structure", "translation": "ŸáŸäŸÉŸÑ", "emoji": "üèóÔ∏è"},
                        {"word": "culture", "translation": "ÿ´ŸÇÿßŸÅÿ©", "emoji": "üé≠"},
                        {"word": "adventure", "translation": "ŸÖÿ∫ÿßŸÖÿ±ÿ©", "emoji": "üß≠"},
                        {"word": "temperature", "translation": "ÿØÿ±ÿ¨ÿ© ÿ≠ÿ±ÿßÿ±ÿ©", "emoji": "üå°Ô∏è"},
                        {"word": "mixture", "translation": "ÿÆŸÑŸäÿ∑", "emoji": "üß™"},
                        {"word": "signature", "translation": "ÿ™ŸàŸÇŸäÿπ", "emoji": "‚úçÔ∏è"},
                        {"word": "creature", "translation": "ŸÖÿÆŸÑŸàŸÇ", "emoji": "üêâ"}
                    ]
                }
            ]
        };

        // DOM Elements
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        const syllableContainer = document.querySelector('.syllable-container');
        const syllableBtns = document.querySelectorAll('.syllable-btn');
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Populate the learning section with all syllables
            populateLearningSection('all');
            
            // Set up tab switching
            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Remove active class from all tabs
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    btn.classList.add('active');
                    document.getElementById(btn.dataset.tab).classList.add('active');
                });
            });
            
            // Set up syllable filtering
            syllableBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    syllableBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    populateLearningSection(btn.dataset.syllable);
                });
            });
            
            // Set up speech synthesis
            window.speechSynthesis.getVoices(); // Prime the voices
            
            // Set up practice section
            setupPracticeSection();
            
            // Set up quiz section
            setupQuizSection();
            
            // Set up games section
            setupGamesSection();
        });

        // Highlight syllable in word
        function highlightSyllable(word, syllable) {
            const index = word.toLowerCase().indexOf(syllable);
            if (index === -1) return word;
            
            return word.substring(0, index) + 
                   `<span class="syllable-highlight">${word.substring(index, index + syllable.length)}</span>` + 
                   word.substring(index + syllable.length);
        }

        // Populate the learning section with syllable cards
        function populateLearningSection(filter) {
            syllableContainer.innerHTML = '';
            
            syllableData.syllables.forEach(syllable => {
                if (filter !== 'all' && filter !== syllable.syllable) return;
                
                const card = document.createElement('div');
                card.className = 'syllable-card';
                
                let html = `<div class="syllable-title">${syllable.syllable}</div>`;
                html += `<div class="examples">`;
                
                syllable.examples.forEach(item => {
                    html += `
                        <div class="example-item">
                            <div class="word-container">
                                <div class="word-emoji">${item.emoji}</div>
                                <div>
                                    <div class="word-text">${highlightSyllable(item.word, syllable.syllable)}</div>
                                    <div class="word-translation">${item.translation}</div>
                                </div>
                            </div>
                            <button class="speaker-btn" data-word="${item.word}">üîä</button>
                        </div>
                    `;
                });
                
                html += `</div>`;
                
                card.innerHTML = html;
                syllableContainer.appendChild(card);
            });
            
            // Add event listeners to speaker buttons
            document.querySelectorAll('.speaker-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    speakWord(btn.dataset.word);
                });
            });
        }

        // Speak a word using Web Speech API
        function speakWord(word) {
            if ('speechSynthesis' in window) {
                // Cancel any ongoing speech
                speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = 'en-US';
                utterance.rate = 0.8; // Slightly slower for children
                utterance.pitch = 1.2; // Slightly higher pitch
                
                // Try to find a child-friendly voice
                const voices = speechSynthesis.getVoices();
                const preferredVoices = ['Google UK English Female', 'Microsoft Hazel Desktop', 
                                       'Samantha', 'Karen', 'Moira', 'Fiona'];
                
                for (const voiceName of preferredVoices) {
                    const voice = voices.find(v => v.name === voiceName);
                    if (voice) {
                        utterance.voice = voice;
                        break;
                    }
                }
                
                speechSynthesis.speak(utterance);
            } else {
                alert('Your browser does not support text-to-speech. Please try Chrome or Edge.');
            }
        }

        // Practice Section Logic
        function setupPracticeSection() {
            const startBtn = document.getElementById('practice-start');
            const nextBtn = document.getElementById('practice-next');
            const speakerBtn = document.getElementById('practice-speaker');
            const wordDisplay = document.getElementById('practice-word');
            const optionsContainer = document.getElementById('practice-options');
            const feedbackDisplay = document.getElementById('practice-feedback');
            
            let practiceWords = [];
            let currentWordIndex = -1;
            
            // Generate practice words from our data
            function generatePracticeWords() {
                practiceWords = [];
                
                syllableData.syllables.forEach(syllable => {
                    syllable.examples.forEach(item => {
                        practiceWords.push({
                            word: item.word,
                            syllable: syllable.syllable
                        });
                    });
                });
                
                // Shuffle the words
                practiceWords = shuffleArray(practiceWords);
            }
            
            startBtn.addEventListener('click', () => {
                generatePracticeWords();
                currentWordIndex = -1;
                nextPracticeWord();
                startBtn.disabled = true;
                nextBtn.disabled = false;
                feedbackDisplay.textContent = '';
            });
            
            nextBtn.addEventListener('click', nextPracticeWord);
            
            speakerBtn.addEventListener('click', () => {
                if (currentWordIndex >= 0 && currentWordIndex < practiceWords.length) {
                    speakWord(practiceWords[currentWordIndex].word);
                }
            });
            
            function nextPracticeWord() {
                currentWordIndex++;
                
                if (currentWordIndex >= practiceWords.length) {
                    wordDisplay.textContent = 'Practice Complete!';
                    optionsContainer.innerHTML = '';
                    speakerBtn.style.visibility = 'hidden';
                    feedbackDisplay.textContent = 'Great job! You practiced all words.';
                    startBtn.disabled = false;
                    nextBtn.disabled = true;
                    return;
                }
                
                const currentWord = practiceWords[currentWordIndex];
                wordDisplay.textContent = '?'.repeat(currentWord.word.length);
                speakerBtn.style.visibility = 'visible';
                feedbackDisplay.textContent = '';
                
                // Create options
                const allSyllables = [...new Set(syllableData.syllables.map(s => s.syllable))];
                const options = shuffleArray([...allSyllables]);
                
                optionsContainer.innerHTML = '';
                options.forEach(syllable => {
                    const optionBtn = document.createElement('div');
                    optionBtn.className = 'option';
                    optionBtn.textContent = syllable;
                    optionBtn.addEventListener('click', () => {
                        checkPracticeAnswer(syllable, currentWord.syllable);
                    });
                    optionsContainer.appendChild(optionBtn);
                });
                
                // Speak the word automatically after a short delay
                setTimeout(() => {
                    speakWord(currentWord.word);
                }, 500);
            }
            
            function checkPracticeAnswer(selected, correct) {
                if (selected === correct) {
                    feedbackDisplay.textContent = 'Correct! üéâ';
                    feedbackDisplay.className = 'feedback correct';
                    wordDisplay.innerHTML = highlightSyllable(practiceWords[currentWordIndex].word, correct);
                } else {
                    feedbackDisplay.textContent = `Try again! The answer is ${correct}`;
                    feedbackDisplay.className = 'feedback incorrect';
                }
            }
        }

        // Quiz Section Logic - FIXED VERSION
        function setupQuizSection() {
            const startBtn = document.getElementById('quiz-start');
            const nextBtn = document.getElementById('quiz-next');
            const questionDisplay = document.getElementById('quiz-question');
            const optionsContainer = document.getElementById('quiz-options');
            const feedbackDisplay = document.getElementById('quiz-feedback');
            const scoreDisplay = document.getElementById('quiz-score');
            const progressText = document.getElementById('progress-text');
            const progressFill = document.getElementById('progress-fill');
            
            let quizQuestions = [];
            let currentQuestionIndex = -1;
            let score = 0;
            
            // Generate quiz questions
            function generateQuizQuestions() {
                quizQuestions = [];
                
                // Question type 1: Which word has the syllable?
                syllableData.syllables.forEach(syllable => {
                    // Get all words for this syllable
                    const allWords = [];
                    syllable.examples.forEach(item => {
                        allWords.push(item.word);
                    });
                    
                    // Create question
                    if (allWords.length > 0) {
                        const correctWord = allWords[Math.floor(Math.random() * allWords.length)];
                        
                        // Get wrong options from other syllables
                        const wrongWords = [];
                        const otherSyllables = syllableData.syllables.filter(s => s.syllable !== syllable.syllable);
                        
                        for (let i = 0; i < 3; i++) {
                            const otherSyllable = otherSyllables[Math.floor(Math.random() * otherSyllables.length)];
                            const otherWords = [];
                            otherSyllable.examples.forEach(item => {
                                otherWords.push(item.word);
                            });
                            
                            if (otherWords.length > 0) {
                                wrongWords.push(otherWords[Math.floor(Math.random() * otherWords.length)]);
                            }
                        }
                        
                        quizQuestions.push({
                            type: 'word-selection',
                            question: `Which word contains the "${syllable.syllable}" syllable?`,
                            options: shuffleArray([correctWord, ...wrongWords]),
                            answer: correctWord
                        });
                    }
                });
                
                // Question type 2: Syllable identification
                syllableData.syllables.forEach(syllable => {
                    if (syllable.examples.length > 0) {
                        const example = syllable.examples[Math.floor(Math.random() * syllable.examples.length)];
                        
                        quizQuestions.push({
                            type: 'syllable-identification',
                            question: `What syllable do you hear in the word "${example.word}"?`,
                            options: shuffleArray(syllableData.syllables.map(s => s.syllable)),
                            answer: syllable.syllable,
                            word: example.word
                        });
                    }
                });
                
                // Shuffle all questions
                quizQuestions = shuffleArray(quizQuestions).slice(0, 10); // Use 10 questions for the quiz
            }
            
            startBtn.addEventListener('click', () => {
                generateQuizQuestions();
                currentQuestionIndex = -1;
                score = 0;
                scoreDisplay.textContent = '0';
                nextQuestion();
                startBtn.disabled = true;
                nextBtn.disabled = false;
                feedbackDisplay.textContent = '';
                updateProgress();
            });
            
            nextBtn.addEventListener('click', nextQuestion);
            
            function nextQuestion() {
                currentQuestionIndex++;
                
                if (currentQuestionIndex >= quizQuestions.length) {
                    questionDisplay.textContent = 'Quiz Complete!';
                    optionsContainer.innerHTML = '';
                    feedbackDisplay.textContent = `Your final score: ${score}/${quizQuestions.length}`;
                    startBtn.disabled = false;
                    nextBtn.disabled = true;
                    return;
                }
                
                const question = quizQuestions[currentQuestionIndex];
                questionDisplay.textContent = question.question;
                feedbackDisplay.textContent = '';
                feedbackDisplay.className = 'feedback';
                
                // Create options
                optionsContainer.innerHTML = '';
                question.options.forEach(option => {
                    const optionBtn = document.createElement('div');
                    optionBtn.className = 'option';
                    optionBtn.textContent = option;
                    optionBtn.addEventListener('click', () => {
                        checkQuizAnswer(option, question.answer, question);
                    });
                    optionsContainer.appendChild(optionBtn);
                });
                
                // Speak the word if it's a syllable identification question
                if (question.type === 'syllable-identification') {
                    setTimeout(() => {
                        speakWord(question.word);
                    }, 800);
                }
                
                updateProgress();
            }
            
            function checkQuizAnswer(selected, correct, question) {
                if (selected === correct) {
                    feedbackDisplay.textContent = 'Correct! üéâ';
                    feedbackDisplay.className = 'feedback correct';
                    score++;
                    scoreDisplay.textContent = score;
                } else {
                    feedbackDisplay.textContent = `Incorrect. The correct answer is ${correct}`;
                    feedbackDisplay.className = 'feedback incorrect';
                }
                
                // Disable all options after selection
                document.querySelectorAll('#quiz-options .option').forEach(opt => {
                    opt.style.pointerEvents = 'none';
                });
                
                nextBtn.disabled = false;
            }
            
            function updateProgress() {
                const progress = currentQuestionIndex + 1;
                progressText.textContent = `${progress}/${quizQuestions.length}`;
                progressFill.style.width = `${(progress / quizQuestions.length) * 100}%`;
            }
        }

        // Games Section Logic
        function setupGamesSection() {
            const startBtn = document.getElementById('game-start');
            const resetBtn = document.getElementById('game-reset');
            const gameGrid = document.getElementById('memory-game');
            const moveCount = document.getElementById('move-count');
            const matchCount = document.getElementById('match-count');
            const timeCount = document.getElementById('time-count');
            
            let gameCards = [];
            let flippedCards = [];
            let matchedPairs = 0;
            let moves = 0;
            let timer = null;
            let seconds = 0;
            
            // Generate game cards
            function generateGameCards() {
                gameCards = [];
                
                // Get 8 random words from our data
                const allWords = [];
                syllableData.syllables.forEach(syllable => {
                    syllable.examples.forEach(item => {
                        allWords.push({
                            word: item.word,
                            emoji: item.emoji,
                            syllable: syllable.syllable
                        });
                    });
                });
                
                const selectedWords = shuffleArray(allWords).slice(0, 8);
                
                // Create pairs
                selectedWords.forEach(item => {
                    gameCards.push({ type: 'word', content: item.word, pair: item.syllable });
                    gameCards.push({ type: 'syllable', content: item.syllable, pair: item.word });
                });
                
                gameCards = shuffleArray(gameCards);
            }
            
            startBtn.addEventListener('click', () => {
                generateGameCards();
                renderGameBoard();
                startBtn.disabled = true;
                resetBtn.disabled = false;
                moves = 0;
                matchedPairs = 0;
                seconds = 0;
                moveCount.textContent = '0';
                matchCount.textContent = '0';
                clearInterval(timer);
                timer = setInterval(() => {
                    seconds++;
                    timeCount.textContent = seconds;
                }, 1000);
            });
            
            resetBtn.addEventListener('click', () => {
                clearInterval(timer);
                startBtn.disabled = false;
                resetBtn.disabled = true;
                gameGrid.innerHTML = '';
            });
            
            function renderGameBoard() {
                gameGrid.innerHTML = '';
                
                gameCards.forEach((card, index) => {
                    const cardElement = document.createElement('div');
                    cardElement.className = 'game-card';
                    cardElement.dataset.index = index;
                    
                    cardElement.innerHTML = `
                        <div class="card-front">?</div>
                        <div class="card-back">${card.type === 'word' ? card.content : card.content}</div>
                    `;
                    
                    cardElement.addEventListener('click', () => flipCard(cardElement, card));
                    gameGrid.appendChild(cardElement);
                });
            }
            
            function flipCard(cardElement, card) {
                // Don't allow flipping if already matched or two cards are already flipped
                if (cardElement.classList.contains('flipped') || 
                    flippedCards.length === 2 || 
                    cardElement.classList.contains('match')) {
                    return;
                }
                
                // Flip the card
                cardElement.classList.add('flipped');
                flippedCards.push({element: cardElement, card: card});
                
                // Check for match when two cards are flipped
                if (flippedCards.length === 2) {
                    moves++;
                    moveCount.textContent = moves;
                    
                    const card1 = flippedCards[0];
                    const card2 = flippedCards[1];
                    
                    // Check if it's a match
                    if ((card1.card.type === 'word' && card2.card.type === 'syllable' && card1.card.content === card2.card.pair) ||
                        (card1.card.type === 'syllable' && card2.card.type === 'word' && card1.card.content === card2.card.pair)) {
                        
                        // Match found
                        setTimeout(() => {
                            card1.element.classList.add('match');
                            card2.element.classList.add('match');
                            flippedCards = [];
                            matchedPairs++;
                            matchCount.textContent = matchedPairs;
                            
                            // Check if game is complete
                            if (matchedPairs === 8) {
                                clearInterval(timer);
                                setTimeout(() => {
                                    alert(`Congratulations! You completed the game in ${seconds} seconds with ${moves} moves!`);
                                }, 500);
                            }
                        }, 500);
                    } else {
                        // Not a match, flip back
                        setTimeout(() => {
                            card1.element.classList.remove('flipped');
                            card2.element.classList.remove('flipped');
                            flippedCards = [];
                        }, 1000);
                    }
                }
            }
        }

        // Utility function to shuffle an array
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
    </script>
</body>
</html>
